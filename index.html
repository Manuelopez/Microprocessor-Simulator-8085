<!DOCTYPE html>
<!--
Copyright 2018 The Go Authors. All rights reserved.
Use of this source code is governed by a BSD-style
license that can be found in the LICENSE file.
-->
<html>
  <head>
    <link rel="stylesheet" href="style.css" />

    <meta charset="utf-8" />
    <title>Go wasm</title>
  </head>

  <body>
    <script src="wasm_exec.js"></script>

    <script>
      let AL
      let AH
      let B
      let C
      let D
      let E
      let L
      let H
      let IR
      let MAR
      let MBR
      let PC
      let MEM
      let SP
      let SMEM

      function updateaDisplay() {}

      function updateRegisters(
        al,
        ah,
        b,
        c,
        d,
        e,
        l,
        h,
        ir,
        mar,
        mbr,
        pc,
        mem,
        sp,
        stackMem
      ) {
        AL = al
        AH = ah
        B = b
        C = c
        D = d
        E = e
        L = l
        H = h
        IR = ir
        MAR = mar
        MBR = mbr
        PC = pc
        MEM = mem
        SP = sp
        SMEM = stackMem

        updateaDisplay()
      }

      if (!WebAssembly.instantiateStreaming) {
        // polyfill
        WebAssembly.instantiateStreaming = async (resp, importObject) => {
          const source = await (await resp).arrayBuffer()
          return await WebAssembly.instantiate(source, importObject)
        }
      }

      const go = new Go()

      let mod, inst

      WebAssembly.instantiateStreaming(fetch('lib.wasm'), go.importObject).then(
        async (result) => {
          mod = result.module
          inst = result.instance
          await go.run(inst)
        }
      )

      function sendInstToGo() {
        sendInst()
      }
    </script>

    <div class="root">

      <textarea class="" id="inst"></textarea>
      <button onClick="sendInstToGo()" id="send">send</button>
      <div class="texteditor">
        <label>AL</label>
        <div id="al" data-value="">0</div>
      </div>

      <div>
        <label>AH</label>
        <div id="ah" data-value="">0</div>
      </div>

      <div>
        <label>B</label>
        <div id="b" data-value="">0</div>
      </div>

      <div>
        <label>C</label>
        <div id="c" data-value="">0</div>
      </div>

      <div>
        <label>D</label>
        <div id="d" data-value="">0</div>
      </div>

      <div>
        <label>E</label>
        <div id="e" data-value="">0</div>
      </div>

      <div>
        <label>L</label>
        <div id="l" data-value="">0</div>
      </div>

      <div>
        <label>H</label>
        <div id="h" data-value="">0</div>
      </div>

      <div>
        <label>IR</label>
        <div id="ir" data-value="">0</div>
      </div>

      <div>
        <label>MAR</label>
        <div id="mar" data-value="">0</div>
      </div>

      <div>
        <label>MBR</label>
        <div id="mbr" data-value="">0</div>
      </div>

      <div>
        <label>PC</label>
        <div id="pc" data-value="">0</div>
      </div>
      <div>
        <label>MEM</label>
        <div id="mem" data-value="">WEll Fuck</div>
      </div>
      <div>
        <label>sp</label>
        <div id="sp" data-value="">0</div>
      </div>
      <div>
        <label>stack mem</label>
        <div id="smem" data-value="">WEll Fuck</div>
      </div>

    </div>

  </body>
</html>
